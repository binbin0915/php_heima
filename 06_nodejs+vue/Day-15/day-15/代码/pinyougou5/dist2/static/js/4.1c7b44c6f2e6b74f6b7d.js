webpackJsonp([4],{"1gz3":function(t,e){},blep:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={data:function(){return{editRolesShow:!1,editRolesData:{roleName:"",roleDesc:""},addRolesShow:!1,addRolesData:{roleName:"",roleDesc:""},roleId:0,checkedArr:[],rightsData:[],defaultProps:{children:"children",label:"authName"},rightsShow:!1,roleListsData:[]}},methods:{editRolePut:function(){var t=this;this.$myHttp({url:"roles/"+this.roleId,method:"put",data:this.editRolesData}).then(function(e){var o=e.data,s=(o.data,o.meta);200==s.status&&(t.$message({message:s.msg,type:"success"}),t.editRolesShow=!1,t.getRoleLists())})},roleEdit:function(t){this.editRolesData.roleName=t.roleName,this.editRolesData.roleDesc=t.roleDesc,this.roleId=t.id,this.editRolesShow=!0},roleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$myHttp({url:"roles/"+t,method:"delete"}).then(function(t){var o=t.data,s=(o.data,o.meta);200==s.status&&(e.getRoleLists(),e.$message({type:"success",message:s.msg}))})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},rolesisShow:function(){this.addRolesShow=!0},addRolePost:function(){var t=this;this.$myHttp({url:"roles",method:"post",data:this.addRolesData}).then(function(e){var o=e.data,s=(o.data,o.meta);201==s.status&&(t.$message({message:s.msg,type:"success"}),t.addRolesShow=!1,t.getRoleLists())})},getRoleLists:function(){var t=this;this.$myHttp({url:"roles",method:"get"}).then(function(e){var o=e.data,s=o.data,a=o.meta;console.log(s,a),200==a.status&&(t.roleListsData=s)})},deleteTag:function(t,e,o,s){var a=this;this.$myHttp({url:"roles/"+o+"/rights/"+s,method:"delete"}).then(function(o){var s=o.data,l=s.data,i=s.meta;console.log(l,i),200==i.status&&(a.$message({message:i.msg,type:"success"}),t.children.splice(e,1))})},rightsisShow:function(t){var e=this;this.roleId=t.id,this.checkedArr=[],t.children.forEach(function(t){t.children.forEach(function(t){t.children.forEach(function(t){e.checkedArr.push(t.id)})})}),this.$myHttp({url:"rights/tree",method:"get"}).then(function(t){var o=t.data,s=o.data;200==o.meta.status&&(e.rightsData=s)}),this.rightsShow=!0},rightsEditPost:function(){var t=this,e=this.$refs.tree.getCheckedKeys().concat(this.$refs.tree.getHalfCheckedKeys()).join();this.$myHttp({url:"roles/"+this.roleId+"/rights",method:"post",data:{rids:e}}).then(function(e){var o=e.data.meta;console.log(o),200==o.status&&(t.$message({message:o.msg,type:"success"}),t.getRoleLists())}),this.rightsShow=!1}},mounted:function(){this.getRoleLists()}},a={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-button",{staticClass:"addjuese",attrs:{type:"primary"},on:{click:t.rolesisShow}},[t._v("添加角色")]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.roleListsData}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.children,function(s){return o("el-row",{key:s.id},[o("el-col",{attrs:{span:6}},[o("el-tag",{key:s.id,attrs:{closable:""}},[t._v(t._s(s.authName))]),t._v(" \n                        > \n                    ")],1),t._v(" "),o("el-col",{attrs:{span:18}},t._l(s.children,function(s){return o("el-row",{key:s.id},[o("el-col",{attrs:{span:6}},[o("el-tag",{key:s.id,attrs:{type:"success",closable:""}},[t._v(t._s(s.authName))]),t._v("\n                                > \n                            ")],1),t._v(" "),o("el-col",{attrs:{span:18}},t._l(s.children,function(a,l){return o("el-tag",{key:a.id,attrs:{type:"warning",closable:""},on:{close:function(o){t.deleteTag(s,l,e.row.id,a.id)}}},[t._v(t._s(a.authName))])}))],1)}))],1)})}}])}),t._v(" "),o("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),t._v(" "),o("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",prop:"desc"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",round:""},on:{click:function(o){t.roleEdit(e.row)}}}),t._v(" "),o("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-delete",round:""},on:{click:function(o){t.roleDelete(e.row.id)}}}),t._v(" "),o("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-check",round:""},on:{click:function(o){t.rightsisShow(e.row)}}})]}}])})],1),t._v(" "),o("el-dialog",{attrs:{title:"分配权限",visible:t.rightsShow},on:{"update:visible":function(e){t.rightsShow=e}}},[o("el-tree",{ref:"tree",attrs:{"default-expand-all":"",data:t.rightsData,"show-checkbox":"","node-key":"id","default-expanded-keys":[2,3],"default-checked-keys":t.checkedArr,props:t.defaultProps}}),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.rightsShow=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.rightsEditPost}},[t._v("确 定")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"添加角色",visible:t.addRolesShow},on:{"update:visible":function(e){t.addRolesShow=e}}},[o("el-form",{attrs:{model:t.addRolesData}},[o("el-form-item",{attrs:{label:"角色名称","label-width":"200px",prop:"username"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.addRolesData.roleName,callback:function(e){t.$set(t.addRolesData,"roleName",e)},expression:"addRolesData.roleName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"角色描述","label-width":"200px",prop:"username"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.addRolesData.roleDesc,callback:function(e){t.$set(t.addRolesData,"roleDesc",e)},expression:"addRolesData.roleDesc"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.addRolesShow=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.addRolePost}},[t._v("确 定")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"修改角色",visible:t.editRolesShow},on:{"update:visible":function(e){t.editRolesShow=e}}},[o("el-form",{attrs:{model:t.editRolesData}},[o("el-form-item",{attrs:{label:"角色名称","label-width":"200px",prop:"username"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.editRolesData.roleName,callback:function(e){t.$set(t.editRolesData,"roleName",e)},expression:"editRolesData.roleName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"角色描述","label-width":"200px",prop:"username"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.editRolesData.roleDesc,callback:function(e){t.$set(t.editRolesData,"roleDesc",e)},expression:"editRolesData.roleDesc"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.editRolesShow=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.editRolePut}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var l=o("VU/8")(s,a,!1,function(t){o("1gz3")},null,null);e.default=l.exports}});
//# sourceMappingURL=4.1c7b44c6f2e6b74f6b7d.js.map