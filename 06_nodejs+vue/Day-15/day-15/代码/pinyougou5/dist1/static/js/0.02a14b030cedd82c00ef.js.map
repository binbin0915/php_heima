{"version":3,"sources":["webpack:///src/components/roles/roles.vue","webpack:///./src/components/roles/roles.vue?900f","webpack:///./src/components/roles/roles.vue"],"names":["roles","data","editRolesShow","editRolesData","roleName","roleDesc","addRolesShow","addRolesData","roleId","checkedArr","rightsData","defaultProps","children","label","rightsShow","roleListsData","methods","editRolePut","_this","this","$myHttp","url","method","then","back","_back$data","meta","status","$message","message","msg","type","getRoleLists","roleEdit","row","id","roleDelete","_this2","$confirm","confirmButtonText","cancelButtonText","_back$data2","catch","rolesisShow","addRolePost","_this3","_back$data3","_this4","_back$data4","console","log","deleteTag","item","key","rightId","_this5","_back$data5","splice","rightsisShow","_this6","forEach","item1","item2","item3","push","_back$data6","rightsEditPost","_this7","rids","$refs","tree","getCheckedKeys","concat","getHalfCheckedKeys","join","mounted","roles_roles","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","click","_v","staticStyle","width","scopedSlots","_u","fn","scope","_l","span","closable","_s","authName","key3","close","$event","prop","size","icon","round","title","visible","update:visible","ref","default-expand-all","show-checkbox","node-key","default-expanded-keys","default-checked-keys","props","slot","model","label-width","autocomplete","value","callback","$$v","$set","expression","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/0.02a14b030cedd82c00ef.js","sourcesContent":["<template>\r\n    <div>\r\n        <el-button class=\"addjuese\" @click=\"rolesisShow\"  type=\"primary\">添加角色</el-button>\r\n        <!-- :data 整个表格中所有数据的数据源 -->\r\n        <el-table\r\n        :data=\"roleListsData\"\r\n        style=\"width: 100%\">\r\n\r\n        <!-- 折叠数据 -->\r\n        <el-table-column type=\"expand\">\r\n            <template slot-scope=\"scope\">\r\n                <!-- el-row是一个大盒子 -->\r\n                <el-row  v-for=\"item1 in  scope.row.children\" :key=\"item1.id\">\r\n                    <!-- el-col是两个小盒子 -->\r\n                    <el-col :span=\"6\">\r\n                        <!-- el-tag 直接方式数据 -->\r\n                        <el-tag :key=\"item1.id\"  closable>{{item1.authName}}</el-tag> \r\n                        > \r\n                    </el-col>\r\n                    <!-- 这是另一个小盒子 -->\r\n                    <el-col :span=\"18\">\r\n                        <!-- 小盒子里面的小盒子 -->\r\n                        <el-row :key=\"item2.id\" v-for=\"item2 in item1.children\">\r\n                            <!-- 小盒子里面的小盒子分为两块 -->\r\n                            <el-col :span=\"6\">\r\n                                <el-tag :key=\"item2.id\" type=\"success\" closable>{{item2.authName}}</el-tag>\r\n                                > \r\n                            </el-col>\r\n                            <el-col :span=\"18\" >\r\n                                <!-- 角色 scope.row.id 角色id -->\r\n                                <!-- 权限的ID item3.id -->\r\n                                <el-tag @close=\"deleteTag(item2,key3,scope.row.id,item3.id)\" v-for=\"(item3,key3) in item2.children\" :key=\"item3.id\" type=\"warning\" closable>{{item3.authName}}</el-tag>\r\n                            </el-col>\r\n                        </el-row>\r\n                    </el-col>\r\n                </el-row>\r\n            </template>\r\n        </el-table-column>\r\n\r\n        <!-- 表头信息 -->\r\n        <el-table-column\r\n        type=\"index\"\r\n        width=\"50\">\r\n        </el-table-column>\r\n        <el-table-column\r\n        label=\"角色名称\"\r\n        prop=\"roleName\">\r\n        </el-table-column>\r\n        <el-table-column\r\n        label=\"角色描述\"\r\n        prop=\"roleDesc\">\r\n        </el-table-column>\r\n        <el-table-column\r\n        label=\"操作\"\r\n        prop=\"desc\">\r\n        <template slot-scope=\"scope\">\r\n           <el-button @click=\"roleEdit(scope.row)\" type=\"primary\" size=\"mini\" icon=\"el-icon-edit\" round></el-button>\r\n            <el-button  @click=\"roleDelete(scope.row.id)\" type=\"success\"  size=\"mini\" icon=\"el-icon-delete\" round></el-button>\r\n            <el-button @click=\"rightsisShow(scope.row)\" type=\"info\"  size=\"mini\"  icon=\"el-icon-check\"  round></el-button>\r\n        </template>\r\n\r\n        </el-table-column>\r\n\r\n\r\n  </el-table>\r\n\r\n    <!-- 分配权限的展示面板 -->\r\n    <el-dialog title=\"分配权限\" :visible.sync=\"rightsShow\">\r\n        <!-- \r\n            default-expand-all 默认展开所有节点\r\n            :data=\"rightsData\"  设置数据源\r\n            show-checkbox 是否设置节点为可选节点\r\n            node-key=\"id\" 本节点唯一id \r\n            :props=\"defaultProps\" 设置展示节点内容\r\n         -->\r\n        <el-tree\r\n        ref=\"tree\"\r\n        default-expand-all\r\n        :data=\"rightsData\"\r\n        show-checkbox\r\n        node-key=\"id\"\r\n        :default-expanded-keys=\"[2, 3]\"\r\n        :default-checked-keys=\"checkedArr\"\r\n        :props=\"defaultProps\">\r\n        </el-tree>\r\n    <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"rightsShow = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"rightsEditPost\">确 定</el-button>\r\n    </div>\r\n    </el-dialog>\r\n\r\n    <!-- 添加角色窗口面板 -->\r\n  <el-dialog title=\"添加角色\" :visible.sync=\"addRolesShow\">\r\n        <!-- 使用双向数据绑定,操作表单数据 -->\r\n        <el-form :model=\"addRolesData\"  >\r\n            <el-form-item label=\"角色名称\" label-width=\"200px\" prop=\"username\">\r\n                <el-input v-model=\"addRolesData.roleName\" autocomplete=\"off\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"角色描述\" label-width=\"200px\" prop=\"username\">\r\n                <el-input v-model=\"addRolesData.roleDesc\" autocomplete=\"off\"></el-input>\r\n            </el-form-item>\r\n           \r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n            <!-- 关闭窗口 -->\r\n            <el-button @click=\"addRolesShow = false\">取 消</el-button>\r\n            <!-- 绑定确定事件,发送数据到服务器入库 -->\r\n            <el-button type=\"primary\" @click=\"addRolePost\">确 定</el-button>\r\n        </div>\r\n    </el-dialog>\r\n\r\n\r\n\r\n  <!-- 修改角色窗口面板 -->\r\n  <el-dialog title=\"修改角色\" :visible.sync=\"editRolesShow\">\r\n        <!-- 使用双向数据绑定,操作表单数据 -->\r\n        <el-form :model=\"editRolesData\"  >\r\n            <el-form-item label=\"角色名称\" label-width=\"200px\" prop=\"username\">\r\n                <el-input v-model=\"editRolesData.roleName\" autocomplete=\"off\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"角色描述\" label-width=\"200px\" prop=\"username\">\r\n                <el-input v-model=\"editRolesData.roleDesc\" autocomplete=\"off\"></el-input>\r\n            </el-form-item>\r\n           \r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n            <!-- 关闭窗口 -->\r\n            <el-button @click=\"editRolesShow = false\">取 消</el-button>\r\n            <!-- 绑定确定事件,发送数据到服务器入库 -->\r\n            <el-button type=\"primary\" @click=\"editRolePut\">确 定</el-button>\r\n        </div>\r\n    </el-dialog>\r\n\r\n\r\n</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      editRolesShow:false,\r\n      editRolesData:{\r\n        roleName: \"\",\r\n        roleDesc: \"\"\r\n      },\r\n\r\n\r\n      // 添加角色面板\r\n      addRolesShow: false,\r\n      addRolesData: {\r\n        roleName: \"\",\r\n        roleDesc: \"\"\r\n      },\r\n      // 保留操作的角色id 默认为0,\r\n      // 默认值是什么无所谓,因为每次使用之前\r\n      // 都会对其重新赋值\r\n      roleId: 0,\r\n\r\n      // 所有选中权限的数组集\r\n      checkedArr: [],\r\n      // 权限数据\r\n      rightsData: [],\r\n      //   设置展示节点内容\r\n      defaultProps: {\r\n        children: \"children\", // 设置子元素是数据中的 children\r\n        label: \"authName\" // 设置节点名称为 数据中的 authName\r\n      },\r\n      // 分派权限面版的控制\r\n      rightsShow: false,\r\n\r\n      // 表格中展示的数据\r\n      roleListsData: []\r\n    };\r\n  },\r\n\r\n  methods: {\r\n\r\n    // 修改角色信息\r\n    editRolePut(){\r\n      // 获取表单数据及角色id\r\n      this.$myHttp({\r\n        url:`roles/${this.roleId}`,\r\n        method:'put',\r\n        data:this.editRolesData\r\n      }).then(back=>{\r\n        let {data,meta} = back.data;\r\n        // console.log(data,meta);\r\n        if(meta.status == 200){\r\n          this.$message({message:meta.msg,type:'success'});\r\n          this.editRolesShow = false;// 关闭窗口\r\n          this.getRoleLists();// 获取数据,重新渲染页面\r\n        }\r\n      });\r\n      \r\n    },\r\n\r\n    // 修改角色弹窗\r\n    roleEdit(row){\r\n      this.editRolesData.roleName = row.roleName;\r\n      this.editRolesData.roleDesc = row.roleDesc;\r\n      this.roleId = row.id;// 被修改角色的id 记录下来,方面提交数据时使用\r\n      this.editRolesShow = true;\r\n    },\r\n\r\n    // 删除角色事件:\r\n    roleDelete(roleId) {\r\n      // 弹窗的二次确认\r\n      this.$confirm(\"此操作将永久删除该角色, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\"\r\n      })\r\n        .then(() => {\r\n          // 如果点击确定按钮,证明确定要执行删除操作\r\n          // 请求接口\r\n          this.$myHttp({\r\n            url: \"roles/\" + roleId,\r\n            method: \"delete\"\r\n          }).then(back => {\r\n            let { data, meta } = back.data;\r\n            // console.log(data,meta);\r\n            if (meta.status == 200) {\r\n              this.getRoleLists();// 获取数据,重新渲染页面\r\n              this.$message({\r\n                type: \"success\",\r\n                message: meta.msg\r\n              });\r\n            }\r\n          });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"已取消删除\"\r\n          });\r\n        });\r\n    },\r\n\r\n    // 展示添加角色弹窗\r\n    rolesisShow() {\r\n      this.addRolesShow = true;\r\n    },\r\n\r\n    // 添加角色按钮\r\n    addRolePost() {\r\n      this.$myHttp({\r\n        url: \"roles\",\r\n        method: \"post\",\r\n        data: this.addRolesData\r\n      }).then(back => {\r\n        let { data, meta } = back.data;\r\n        // console.log(data,meta);\r\n        if (meta.status == 201) {\r\n          this.$message({ message: meta.msg, type: \"success\" });\r\n          this.addRolesShow = false; // 关掉窗口\r\n          this.getRoleLists(); // 重新加载数据\r\n        }\r\n      });\r\n    },\r\n\r\n    //   获取所有角色信息\r\n    getRoleLists() {\r\n      this.$myHttp({\r\n        url: \"roles\",\r\n        method: \"get\"\r\n      }).then(back => {\r\n        let { data, meta } = back.data;\r\n        console.log(data, meta);\r\n        if (meta.status == 200) {\r\n          this.roleListsData = data;\r\n        }\r\n      });\r\n    },\r\n\r\n    // 删除角色权限标签\r\n    deleteTag(item, key, roleId, rightId) {\r\n      // 需要 角色id  权限ID\r\n      this.$myHttp({\r\n        // 拼接URL\r\n        url: `roles/${roleId}/rights/${rightId}`,\r\n        method: \"delete\"\r\n      }).then(back => {\r\n        let { data, meta } = back.data;\r\n        console.log(data, meta);\r\n        // 判断是否成功\r\n        if (meta.status == 200) {\r\n          // 提示信息\r\n          this.$message({ message: meta.msg, type: \"success\" });\r\n          // 数组使用引用传递,直接删除父级数组中的第几个就会影响到全局所有数据\r\n          item.children.splice(key, 1); // 删除页面展示权限\r\n        }\r\n      });\r\n    },\r\n\r\n    // 控制权限分配面板的显示\r\n    rightsisShow(row) {\r\n      this.roleId = row.id;\r\n      // 获取本角色拥有的所有数据,数据中有权限\r\n      // console.log(row);\r\n      // row.children.children.children.id\r\n      // 为了防止其他数据的影响,每次获取权限都要先清空以前的权限数据\r\n      this.checkedArr = [];\r\n      //    角色数据中的 children 就是这个角色所拥有的所有权限\r\n      var arr = row.children;\r\n      arr.forEach(item1 => {\r\n        item1.children.forEach(item2 => {\r\n          item2.children.forEach(item3 => {\r\n            // 因为 elUI中只要有一个第三级权限被选中,父级也会被半选中\r\n            // 所以,我们只需要获取第三季权限,父级及爷爷级权限都会被选中\r\n            this.checkedArr.push(item3.id);\r\n          });\r\n        });\r\n      });\r\n\r\n      // 获取所有权限\r\n      this.$myHttp({\r\n        // url:`rights/list`\r\n        // 获取树状结构的数据更为合适\r\n        url: `rights/tree`,\r\n        method: \"get\"\r\n      }).then(back => {\r\n        let { data, meta } = back.data;\r\n        if (meta.status == 200) {\r\n          //   console.log(data);\r\n          //   将获取到的所有权限数据.以树状结构展示到页面中\r\n          this.rightsData = data;\r\n        }\r\n      });\r\n      this.rightsShow = true;\r\n    },\r\n\r\n    // 修改角色权限的事件\r\n    rightsEditPost() {\r\n      // getCheckedKeys 获取所有选中节点的key 数组形式返回\r\n      // getHalfCheckedKeys 获取所有本选中节点的key 数组\r\n      // var a = this.$refs.tree.getCheckedKeys();\r\n      // var b = this.$refs.tree.getHalfCheckedKeys();\r\n      // concat  合并两个数组\r\n      // var c = a.concat(b);\r\n      // join 将数组以,隔开的形式转为字符串\r\n      // console.log(c.join());\r\n      // 生三个变量\r\n      var rids = this.$refs.tree\r\n        .getCheckedKeys()\r\n        .concat(this.$refs.tree.getHalfCheckedKeys())\r\n        .join();\r\n      this.$myHttp({\r\n        url: `roles/${this.roleId}/rights`,\r\n        method: \"post\",\r\n        data: { rids }\r\n      }).then(back => {\r\n        let { meta } = back.data;\r\n        console.log(meta);\r\n        if (meta.status == 200) {\r\n          this.$message({ message: meta.msg, type: \"success\" });\r\n          // 修改成功后,重新获取数据\r\n          this.getRoleLists();\r\n        }\r\n      });\r\n      this.rightsShow = false;\r\n    }\r\n  },\r\n  //  在页面渲染之前获取所有角色数据\r\n  mounted() {\r\n    //   调用获取角色信息的方法\r\n    this.getRoleLists();\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.demo-table-expand {\r\n  font-size: 0;\r\n}\r\n.demo-table-expand label {\r\n  width: 90px;\r\n  color: #99a9bf;\r\n}\r\n.demo-table-expand .el-form-item {\r\n  margin-right: 0;\r\n  margin-bottom: 0;\r\n  width: 50%;\r\n}\r\n.el-main {\r\n  line-height: 20px;\r\n}\r\n.addjuese {\r\n  float: left;\r\n}\r\n.el-tag {\r\n  margin-top: 10px;\r\n  margin-right: 5px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/roles/roles.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-button',{staticClass:\"addjuese\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.rolesisShow}},[_vm._v(\"添加角色\")]),_vm._v(\" \"),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.roleListsData}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return _vm._l((scope.row.children),function(item1){return _c('el-row',{key:item1.id},[_c('el-col',{attrs:{\"span\":6}},[_c('el-tag',{key:item1.id,attrs:{\"closable\":\"\"}},[_vm._v(_vm._s(item1.authName))]),_vm._v(\" \\n                        > \\n                    \")],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":18}},_vm._l((item1.children),function(item2){return _c('el-row',{key:item2.id},[_c('el-col',{attrs:{\"span\":6}},[_c('el-tag',{key:item2.id,attrs:{\"type\":\"success\",\"closable\":\"\"}},[_vm._v(_vm._s(item2.authName))]),_vm._v(\"\\n                                > \\n                            \")],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":18}},_vm._l((item2.children),function(item3,key3){return _c('el-tag',{key:item3.id,attrs:{\"type\":\"warning\",\"closable\":\"\"},on:{\"close\":function($event){_vm.deleteTag(item2,key3,scope.row.id,item3.id)}}},[_vm._v(_vm._s(item3.authName))])}))],1)}))],1)})}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"type\":\"index\",\"width\":\"50\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"prop\":\"desc\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\",\"icon\":\"el-icon-edit\",\"round\":\"\"},on:{\"click\":function($event){_vm.roleEdit(scope.row)}}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"mini\",\"icon\":\"el-icon-delete\",\"round\":\"\"},on:{\"click\":function($event){_vm.roleDelete(scope.row.id)}}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"info\",\"size\":\"mini\",\"icon\":\"el-icon-check\",\"round\":\"\"},on:{\"click\":function($event){_vm.rightsisShow(scope.row)}}})]}}])})],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"分配权限\",\"visible\":_vm.rightsShow},on:{\"update:visible\":function($event){_vm.rightsShow=$event}}},[_c('el-tree',{ref:\"tree\",attrs:{\"default-expand-all\":\"\",\"data\":_vm.rightsData,\"show-checkbox\":\"\",\"node-key\":\"id\",\"default-expanded-keys\":[2, 3],\"default-checked-keys\":_vm.checkedArr,\"props\":_vm.defaultProps}}),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.rightsShow = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.rightsEditPost}},[_vm._v(\"确 定\")])],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"添加角色\",\"visible\":_vm.addRolesShow},on:{\"update:visible\":function($event){_vm.addRolesShow=$event}}},[_c('el-form',{attrs:{\"model\":_vm.addRolesData}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"label-width\":\"200px\",\"prop\":\"username\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.addRolesData.roleName),callback:function ($$v) {_vm.$set(_vm.addRolesData, \"roleName\", $$v)},expression:\"addRolesData.roleName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"角色描述\",\"label-width\":\"200px\",\"prop\":\"username\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.addRolesData.roleDesc),callback:function ($$v) {_vm.$set(_vm.addRolesData, \"roleDesc\", $$v)},expression:\"addRolesData.roleDesc\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.addRolesShow = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addRolePost}},[_vm._v(\"确 定\")])],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"修改角色\",\"visible\":_vm.editRolesShow},on:{\"update:visible\":function($event){_vm.editRolesShow=$event}}},[_c('el-form',{attrs:{\"model\":_vm.editRolesData}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"label-width\":\"200px\",\"prop\":\"username\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.editRolesData.roleName),callback:function ($$v) {_vm.$set(_vm.editRolesData, \"roleName\", $$v)},expression:\"editRolesData.roleName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"角色描述\",\"label-width\":\"200px\",\"prop\":\"username\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.editRolesData.roleDesc),callback:function ($$v) {_vm.$set(_vm.editRolesData, \"roleDesc\", $$v)},expression:\"editRolesData.roleDesc\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.editRolesShow = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editRolePut}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4a2b872a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/roles/roles.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4a2b872a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./roles.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./roles.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./roles.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4a2b872a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./roles.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/roles/roles.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}